#!/bin/sh

echo "---------------------------------------------------------------------------------------"
echo "-------------------------------- Eureka Server 구동 대기 --------------------------------"
echo "---------------------------------------------------------------------------------------"
while ! `nc -z eurekaserver $EUREKA_PORT`; do sleep 3; echo "-------- Eureka Server 대기중 ... sleep 3 -------"; done

echo "================================== Eureka Server 구동 =================================="


echo "---------------------------------------------------------------------------------------"
echo "-------------------------------- Config Server 구동 대기 --------------------------------"
echo "---------------------------------------------------------------------------------------"
while ! `nc -z configserver $CONFIG_PORT`; do sleep 3; echo "-------- Config Server 대기중 ... sleep 3 -------"; done
echo "================================== Config Server 구동 =================================="

echo "---------------------------------------------------------------------------------------"
echo "---------------------------------- DB Server 구동 대기 ----------------------------------"
echo "---------------------------------------------------------------------------------------"
while ! `nc -z database $DB_PORT`; do sleep 3; echo "-------- DB Server 대기중 ... sleep 3 -------"; done
echo "==================================== DB Server 구동 ===================================="

echo "======================================================================================="
echo "================================== Licensing Service 구동 =================================="
echo "======================================================================================="
java -Dspring.profiles.active=$PROFILE \
     -Dserver.port=$SERVER_PORT \
     -Dspring.cloud.config.uri=http://configserver:8888 \
     -jar licensing-service.jar
